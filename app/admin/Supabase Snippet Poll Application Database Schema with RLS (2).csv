schemaname,tablename,policyname,command,permissive,roles,using_clause,with_check_clause
public,admin_actions,Admins can create admin actions,INSERT,PERMISSIVE,{public},null,"(auth.uid() IN ( SELECT user_profiles.id
   FROM user_profiles
  WHERE ((user_profiles.role)::text = 'admin'::text)))"
public,comment_votes,Authenticated users can vote on comments,INSERT,PERMISSIVE,{public},null,"((auth.uid() = user_id) AND (comment_id IN ( SELECT comments.id
   FROM comments
  WHERE (comments.poll_id IN ( SELECT polls.id
           FROM polls
          WHERE (polls.is_active = true))))))"
public,comment_votes,Users can delete own comment votes,DELETE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,comment_votes,Users can update own comment votes,UPDATE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,comment_votes,Users can view votes for visible comments,SELECT,PERMISSIVE,{public},"(comment_id IN ( SELECT comments.id
   FROM comments
  WHERE ((comments.poll_id IN ( SELECT polls.id
           FROM polls
          WHERE (polls.is_active = true))) AND (comments.is_deleted = false))))",null
public,comments,Admins can delete any comment,DELETE,PERMISSIVE,{public},"(EXISTS ( SELECT 1
   FROM user_profiles
  WHERE ((user_profiles.id = auth.uid()) AND ((user_profiles.role)::text = ANY ((ARRAY['admin'::character varying, 'moderator'::character varying])::text[])))))",null
public,comments,Authenticated users can create comments,INSERT,PERMISSIVE,{public},null,"((auth.uid() = user_id) AND (poll_id IN ( SELECT polls.id
   FROM polls
  WHERE (polls.is_active = true))))"
public,comments,Users can reply to any comment,INSERT,PERMISSIVE,{public},null,"((auth.uid() = user_id) AND (parent_id IS NOT NULL) AND (poll_id IN ( SELECT polls.id
   FROM polls
  WHERE (polls.is_active = true))))"
public,comments,Users can soft delete own comments,UPDATE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,comments,Users can update own comments,UPDATE,PERMISSIVE,{public},((auth.uid() = user_id) AND (is_deleted = false)),null
public,comments,Users can view comments for visible polls,SELECT,PERMISSIVE,{public},"((poll_id IN ( SELECT polls.id
   FROM polls
  WHERE (polls.is_active = true))) AND (is_deleted = false))",null
public,daily_analytics,Only service role can view daily analytics,SELECT,PERMISSIVE,{public},(auth.role() = 'service_role'::text),null
public,notification_preferences,Read own prefs,SELECT,PERMISSIVE,{public},(auth.uid() = user_id),null
public,notification_preferences,Update own prefs,UPDATE,PERMISSIVE,{public},(auth.uid() = user_id),(auth.uid() = user_id)
public,notification_preferences,Upsert own prefs,INSERT,PERMISSIVE,{public},null,(auth.uid() = user_id)
public,options,Users can create options for own polls,INSERT,PERMISSIVE,{authenticated},null,"(EXISTS ( SELECT 1
   FROM polls p
  WHERE ((p.id = options.poll_id) AND (p.user_id = auth.uid()))))"
public,options,Users can delete options for own polls,DELETE,PERMISSIVE,{public},"(poll_id IN ( SELECT polls.id
   FROM polls
  WHERE (polls.user_id = auth.uid())))",null
public,options,Users can update options for own polls,UPDATE,PERMISSIVE,{public},"(poll_id IN ( SELECT polls.id
   FROM polls
  WHERE (polls.user_id = auth.uid())))",null
public,options,Users can view options for visible polls,SELECT,PERMISSIVE,{public},"(poll_id IN ( SELECT polls.id
   FROM polls
  WHERE ((polls.is_active = true) OR (polls.user_id = auth.uid()))))",null
public,poll_analytics,Users can view their own poll analytics,SELECT,PERMISSIVE,{public},(user_id = auth.uid()),null
public,polls,Authenticated users can create polls,INSERT,PERMISSIVE,{authenticated},null,(auth.uid() = user_id)
public,polls,Users and admins can view polls,SELECT,PERMISSIVE,{public},"((is_active = true) OR (auth.uid() = user_id) OR (auth.uid() IN ( SELECT user_profiles.id
   FROM user_profiles
  WHERE ((user_profiles.role)::text = 'admin'::text))))",null
public,polls,Users can create polls,INSERT,PERMISSIVE,{public},null,(auth.uid() = user_id)
public,polls,Users can delete own polls,DELETE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,polls,Users can update own polls,UPDATE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,polls,Users can view active polls,SELECT,PERMISSIVE,{public},((is_active = true) OR (user_id = auth.uid())),null
public,polls,Users can view own polls,SELECT,PERMISSIVE,{public},(auth.uid() = user_id),null
public,role_permissions,Authenticated users can view role permissions,SELECT,PERMISSIVE,{public},(auth.role() = 'authenticated'::text),null
public,user_profiles,insert_own_profile,INSERT,PERMISSIVE,{public},null,(auth.uid() = id)
public,user_profiles,read_active_profiles,SELECT,PERMISSIVE,{public},(is_active = true),null
public,user_profiles,update_own_profile,UPDATE,PERMISSIVE,{public},(auth.uid() = id),(auth.uid() = id)
public,user_sessions,Users can delete their own sessions,DELETE,PERMISSIVE,{public},(user_id = auth.uid()),null
public,user_sessions,Users can insert their own sessions,INSERT,PERMISSIVE,{public},null,(user_id = auth.uid())
public,user_sessions,Users can update their own sessions,UPDATE,PERMISSIVE,{public},(user_id = auth.uid()),null
public,user_sessions,Users can view their own sessions,SELECT,PERMISSIVE,{public},(user_id = auth.uid()),null
public,votes,Authenticated users can vote,INSERT,PERMISSIVE,{public},null,(auth.uid() = user_id)
public,votes,Users and admins can view votes,SELECT,PERMISSIVE,{public},"(poll_id IN ( SELECT polls.id
   FROM polls
  WHERE ((polls.is_active = true) OR (polls.user_id = auth.uid()) OR (auth.uid() IN ( SELECT user_profiles.id
           FROM user_profiles
          WHERE ((user_profiles.role)::text = 'admin'::text))))))",null
public,votes,Users can create votes,INSERT,PERMISSIVE,{public},null,(auth.uid() = user_id)
public,votes,Users can delete own poll votes,DELETE,PERMISSIVE,{public},(auth.uid() = user_id),null
public,votes,Users can update own poll votes,UPDATE,PERMISSIVE,{public},(auth.uid() = user_id),null